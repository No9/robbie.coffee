// Generated by CoffeeScript 1.3.3
var fittest, i, launch_worker, run_continually, run_sim, _i, _len, _ref;

fittest = (new Simulation).random_dna();

launch_worker = function() {
  var worker1;
  worker1 = new Worker("/javascripts/robbie/worker.js");
  worker1.postMessage("");
  return worker1.onmessage = function(message) {
    var _ref;
    if (((_ref = message.data) != null ? _ref.dna : void 0) != null) {
      return fittest = message.data.dna;
    } else {
      return console.log(message.data);
    }
  };
};

_ref = [0];
for (_i = 0, _len = _ref.length; _i < _len; _i++) {
  i = _ref[_i];
  launch_worker();
}

run_sim = function() {
  var animation_rate, count, s, step;
  s = new Simulation(fittest);
  s.display_canvas('board');
  animation_rate = 100;
  count = 0;
  step = function() {
    s.step();
    s.display_canvas('board');
    count++;
    if (count === 200) {
      return;
    }
    return setTimeout(step, animation_rate);
  };
  return step();
};

run_continually = function() {
  run_sim();
  return setTimeout(run_continually, 0);
};

setTimeout(run_continually, 5000);

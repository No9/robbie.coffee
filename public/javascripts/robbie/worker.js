// Generated by CoffeeScript 1.3.3

importScripts('/socket.io/socket.io.js');

importScripts('/javascripts/underscore.js');

importScripts('/javascripts/tth_.js');

importScripts('/javascripts/robbie/simulation.js');

this.onmessage = function(event) {
  var socket;
  socket = io.connect('http://localhost:9292');
  socket.on('population', function(population) {
    var new_population, strategy;
    postMessage("recieved");
    new_population = (function() {
      var _i, _len, _results;
      _results = [];
      for (_i = 0, _len = population.length; _i < _len; _i++) {
        strategy = population[_i];
        _results.push({
          dna: strategy.dna,
          fitness: new Simulation(strategy.dna).fitness()
        });
      }
      return _results;
    })();
    return socket.emit('result', new_population);
  });
  socket.on('connect_failed', function() {
    return postMessage('connect failed');
  });
  return socket.on('error', function() {
    return postMessage('error');
  });
};
